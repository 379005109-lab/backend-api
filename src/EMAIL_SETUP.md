# 邮件服务配置说明

## 功能说明

当有新订单创建时，系统会自动向管理员邮箱发送邮件通知。

## 配置步骤

### 1. 开启QQ邮箱SMTP服务

1. 登录QQ邮箱
2. 点击左上角"设置" -> "账户"
3. 找到"POP3/IMAP/SMTP/Exchange/CardDAV/CalDAV服务"
4. 开启"POP3/SMTP服务"或"IMAP/SMTP服务"
5. 按照提示获取授权码（16位授权码，不是QQ密码）

### 2. 配置环境变量

在 `server` 目录下创建 `.env` 文件，添加以下配置：

```env
# 邮件服务配置（QQ邮箱）
EMAIL_HOST=smtp.qq.com
EMAIL_PORT=465
EMAIL_USER=your_email@qq.com
EMAIL_PASS=your_qq_email_authorization_code

# 管理员邮箱（接收订单通知）
ADMIN_EMAIL=379005109@qq.com
```

### 3. 配置说明

- `EMAIL_HOST`: QQ邮箱SMTP服务器地址（smtp.qq.com）
- `EMAIL_PORT`: SMTP端口（465用于SSL，587用于TLS）
- `EMAIL_USER`: 发送邮件的QQ邮箱地址
- `EMAIL_PASS`: QQ邮箱授权码（不是QQ密码）
- `ADMIN_EMAIL`: 接收订单通知的管理员邮箱（默认：379005109@qq.com）

### 4. 测试邮件服务

配置完成后，重启服务器。当有新订单创建时，系统会自动发送邮件通知。

## 邮件内容

邮件包含以下信息：
- 订单号
- 下单时间
- 订单状态
- 客户信息（用户名、邮箱、电话）
- 收货信息（收货人、联系电话、收货地址）
- 商品明细（商品名称、数量、单价、小计）
- 订单总额
- 备注信息（如有）

## 注意事项

1. **授权码不是QQ密码**：必须使用QQ邮箱生成的授权码
2. **安全性**：不要将 `.env` 文件提交到版本控制系统
3. **邮件发送失败不影响订单创建**：如果邮件发送失败，订单仍然会正常创建，但会在控制台记录错误日志
4. **开发环境**：如果未配置邮件服务，系统会在控制台输出订单信息，不会发送邮件

## 故障排查

1. **邮件发送失败**
   - 检查授权码是否正确
   - 检查是否开启了SMTP服务
   - 检查防火墙是否阻止了SMTP连接

2. **收不到邮件**
   - 检查垃圾邮件文件夹
   - 检查 `ADMIN_EMAIL` 配置是否正确
   - 查看服务器控制台日志

3. **连接超时**
   - 检查网络连接
   - 尝试使用端口 587（TLS）而不是 465（SSL）

